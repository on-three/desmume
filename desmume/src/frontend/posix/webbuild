#!/bin/bash

CXXFLAGS=""
CXXFLAGS+="-O3 "
CXXFLAGS+="-g "
CXXFLAGS+="-s AGGRESSIVE_VARIABLE_ELIMINATION=1 "

CPPFLAGS=""
CPPFLAGS+="-s TOTAL_MEMORY=256MB "
CPPFLAGS+="-s ALLOW_MEMORY_GROWTH=1 "
CPPFLAGS+="-s USE_ZLIB=1 "
CPPFLAGS+="-s USE_SDL=2 "
CPPFLAGS+="-s WASM=1 "

LDFLAGS=""
LDFLAGS+="-s TOTAL_MEMORY=256MB "
LDFLAGS+="-s ALLOW_MEMORY_GROWTH=1 "
LDFLAGS+="-s WASM=1 "
LDFLAGS+="-s USE_ZLIB=1 "
LDFLAGS+="-s USE_SDL=2 "
LDFLAGS+="-s EXTRA_EXPORTED_RUNTIME_METHODS='[\"ccall\", \"cwrap\"]'"

emmake make CXXFLAGS="${CXXFLAGS}" CPPFLAGS="${CPPFLAGS}" LDFLAGS="${LDFLAGS}" EXEEXT=.js
